{{#docstring}}
{{docstring}}
{{/docstring}}
{{#importDoc}}
{{>importDoc}}

import thrift from 'thrift'
import {Thrift, Protocol, Int64} from 'thrift'

{{requireStatements}}
{{/importDoc}}

export interface I{{StructName}}Args {
{{#fakeFields}}
    {{fieldName}}{{#optional}}?{{/optional}}: {{fieldType}}
{{/fakeFields}}
{{#fields}}
    {{fieldName}}{{#optional}}?{{/optional}}: {{fieldType}}
{{/fields}}
}

export class {{StructName}} {
{{#fakeFields}}
    public {{fieldName}}: {{fieldType}}
{{/fakeFields}}
{{#fields}}
    public {{fieldName}}: {{fieldType}}
{{/fields}}
    // If possible, populate this with .populate method instead so that
    // we can ensure the struct is constructed correctly
constructor({{^has_fields}}_{{/has_fields}}args?: I{{StructName}}Args) {
{{#has_fields}}{{#fakeFields.length}}
        if (args) {
{{#fields}}
            if (args.{{fieldName}} != null) {
                this.{{fieldName}} = args.{{fieldName}}
            }
{{/fields}}
{{#fakeFields}}
    if (args.{{fieldName}} != null) {
    this.{{fieldName}} = args.{{fieldName}}
    }{{^optional}} else {
    throw new Thrift.TProtocolException(Thrift.TProtocolExceptionType.UNKNOWN, 'Required field {{fieldName}} is unset!')
    }{{/optional}}
{{/fakeFields}}
        }
{{/fakeFields.length}}{{/has_fields}}
    }
    populate(args: I{{StructName}}Args) {
{{#fields}}
            if (args.{{fieldName}} != null) {
                this.{{fieldName}} = args.{{fieldName}}
            }{{^optional}} else {
                throw new Thrift.TProtocolException(Thrift.TProtocolExceptionType.UNKNOWN, 'Required field {{fieldName}} is unset!')
            }{{/optional}}
{{/fields}}
{{#fakeFields}}
    if (args.{{fieldName}} != null) {
    this.{{fieldName}} = args.{{fieldName}}
    }{{^optional}} else {
    throw new Thrift.TProtocolException(Thrift.TProtocolExceptionType.UNKNOWN, 'Required field {{fieldName}} is unset!')
    }{{/optional}}
{{/fakeFields}}
    }

    public read(input: Protocol): void {
        input.readStructBegin()
        while (true) {
{{#has_fields}}
    const {ftype, fid} = input.readFieldBegin()
{{/has_fields}}
{{^has_fields}}
    const {ftype} = input.readFieldBegin()
{{/has_fields}}
            if (ftype === Thrift.Type.STOP) {
                break
            }
{{#has_fields}}
            switch (fid) {
{{#fields}}
                case {{id}}:
                    {{>readField}}
                    break
{{/fields}}
                default:
                    input.skip(ftype)
            }
{{/has_fields}}
{{^has_fields}}
            input.skip(ftype)
{{/has_fields}}
            input.readFieldEnd()
        }
        input.readStructEnd()
        return
    }

    public write(output: Protocol): void {
        output.writeStructBegin("{{StructName}}")
{{#fields}}
        if (this.{{fieldName}} != null) {
            {{>writeField}}
        }
{{/fields}}
        output.writeFieldStop()
        output.writeStructEnd()
        return
    }
}
